@echo off
chcp 65001 > nul
:: 65001 - UTF-8

:: Admin rights check
if "%1"=="admin" (
    echo Started with admin rights
) else (
    echo Requesting admin rights...
    powershell -Command "Start-Process 'cmd.exe' -ArgumentList '/c \"\"%~f0\" admin\"' -Verb RunAs"
    exit /b
)

set "LISTS=%~dp0lists\"
set "FILE=%LISTS%ipset-cloudflare.txt"

if not exist "%FILE%" (
    echo Error! ipset-cloudflare.txt not found, path: %FILE%
    goto :eof
)

findstr /C:"0.0.0.0" "%FILE%" >nul
if %ERRORLEVEL%==0 (
    echo Enabling cloudflare bypass...
    >"%FILE%" (
        echo 173.245.48.0/20
        echo 103.21.244.0/22
        echo 103.22.200.0/22
        echo 103.31.4.0/22
        echo 141.101.64.0/18
        echo 108.162.192.0/18
        echo 190.93.240.0/20
        echo 188.114.96.0/20
        echo 197.234.240.0/22
        echo 198.41.128.0/17
        echo 162.158.0.0/15
        echo 104.16.0.0/13
        echo 104.24.0.0/14
        echo 172.64.0.0/13
        echo 131.0.72.0/22
        echo 1.44.96.0/24
echo 1.178.72.0/21
echo 1.186.0.0/16
echo 2.16.0.0/13
echo 2.16.12.0/23
echo 2.16.30.0/23
echo 2.16.32.0/23
echo 2.16.38.0/23
echo 2.16.42.0/23
echo 2.16.46.0/23
echo 2.16.56.0/22
echo 2.16.68.0/23
echo 2.16.78.0/23
echo 2.16.80.0/23
echo 2.16.96.0/22
echo 2.16.104.0/23
echo 2.16.112.0/23
echo 2.16.124.0/23
echo 2.16.140.0/23
echo 2.16.146.0/23
echo 2.16.174.0/23
echo 2.16.176.0/22
echo 2.16.184.0/23
echo 2.16.192.0/22
echo 2.16.208.0/21
echo 2.16.216.0/22
echo 2.16.224.0/21
echo 2.16.232.0/22
echo 2.16.248.0/21
echo 2.17.0.0/21
echo 2.17.16.0/22
echo 2.17.28.0/22
echo 2.17.48.0/21
echo 2.17.64.0/19
echo 2.17.96.0/22
echo 2.17.124.0/22
echo 2.17.128.0/22
echo 2.17.136.0/21
echo 2.17.148.0/22
echo 2.17.152.0/21
echo 2.17.168.0/21
echo 2.17.176.0/20
echo 2.17.212.0/22
echo 2.17.220.0/22
echo 2.17.240.0/21
echo 2.18.12.0/22
echo 2.18.32.0/21
echo 2.18.68.0/22
echo 2.18.72.0/22
echo 2.18.80.0/21
echo 2.18.96.0/21
echo 2.18.108.0/22
echo 2.18.128.0/20
echo 2.18.160.0/22
echo 2.18.168.0/21
echo 2.18.192.0/20
echo 2.18.220.0/22
echo 2.18.224.0/20
echo 2.19.0.0/22
echo 2.19.12.0/22
echo 2.19.16.0/20
echo 2.19.32.0/20
echo 2.19.56.0/21
echo 2.19.64.0/20
echo 2.19.84.0/22
echo 2.19.88.0/22
echo 2.19.100.0/22
echo 2.19.104.0/21
echo 2.19.112.0/22
echo 2.19.128.0/19
echo 2.19.164.0/22
echo 2.19.168.0/22
echo 2.19.188.0/22
echo 2.19.216.0/21
echo 2.19.224.0/20
echo 2.19.244.0/22
echo 2.20.4.0/22
echo 2.20.8.0/22
echo 2.20.16.0/21
echo 2.20.28.0/22
echo 2.20.32.0/21
echo 2.20.40.0/22
echo 2.20.52.0/22
echo 2.20.56.0/21
echo 2.20.64.0/22
echo 2.20.72.0/21
echo 2.20.80.0/20
echo 2.20.128.0/22
echo 2.20.144.0/21
echo 2.20.156.0/22
echo 2.20.160.0/20
echo 2.20.176.0/23
echo 2.20.192.0/22
echo 2.20.200.0/21
echo 2.20.208.0/20
echo 2.20.224.0/20
echo 2.20.240.0/23
echo 2.21.16.0/22
echo 2.21.40.0/21
echo 2.21.48.0/20
echo 2.21.80.0/21
echo 2.21.100.0/22
echo 2.21.134.0/23
echo 2.21.136.0/21
echo 2.21.144.0/20
echo 2.21.168.0/22
echo 2.21.176.0/21
echo 2.21.184.0/22
echo 2.21.192.0/19
echo 2.21.224.0/22
echo 2.21.238.0/23
echo 2.21.248.0/21
echo 2.22.0.0/20
echo 2.22.16.0/22
echo 2.22.20.0/23
echo 2.22.24.0/22
echo 2.22.32.0/22
echo 2.22.44.0/22
echo 2.22.56.0/22
echo 2.22.64.0/21
echo 2.22.76.0/22
echo 2.22.80.0/22
echo 2.22.96.0/20
echo 2.22.112.0/22
echo 2.22.120.0/21
echo 2.22.128.0/20
echo 2.22.152.0/21
echo 2.22.160.0/21
echo 2.22.208.0/20
echo 2.22.246.0/23
echo 2.23.8.0/22
echo 2.23.16.0/20
echo 2.23.64.0/20
echo 2.23.104.0/21
echo 2.23.112.0/20
echo 2.23.136.0/21
echo 2.23.144.0/22
echo 2.23.160.0/22
echo 2.23.180.0/22
echo 2.23.192.0/21
echo 2.23.200.0/22
echo 2.23.212.0/22
echo 2.23.216.0/22
echo 2.56.148.0/23
echo 2.56.150.0/24
echo 2.56.220.0/24
echo 2.57.12.0/24
echo 2.58.103.0/24
echo 2.59.57.0/24
echo 2.59.60.0/24
echo 2.255.190.0/23
echo 3.0.0.0/15
echo 3.2.0.0/22
echo 3.2.4.0/23
echo 3.2.8.0/21
echo 3.2.48.0/21
echo 3.2.56.0/22
echo 3.3.0.0/22
echo 3.3.5.0/24
echo 3.3.6.0/23
echo 3.3.8.0/21
echo 3.3.16.0/20
echo 3.3.32.0/23
echo 3.4.0.0/22
echo 3.4.4.0/24
echo 3.4.6.0/23
echo 3.4.8.0/23
echo 3.4.10.0/24
echo 3.4.12.1/32
echo 3.4.12.2/31
echo 3.4.12.4/31
echo 3.4.12.6/32
echo 3.4.12.11/32
echo 3.4.12.12/32
echo 3.4.12.15/32
echo 3.4.12.16/28
echo 3.4.12.32/29
echo 3.4.12.40/30
echo 3.4.12.44/31
echo 3.4.12.46/32
echo 3.4.12.49/32
echo 3.4.12.50/31
echo 3.4.12.52/31
echo 3.4.12.54/32
echo 3.4.13.0/26
echo 3.4.13.64/27
echo 3.4.15.0/25
echo 3.4.15.128/28
echo 3.4.15.152/29
echo 3.4.15.160/28
echo 3.4.16.0/20
echo 3.4.32.0/20
echo 3.5.0.0/18
echo 3.5.64.0/21
echo 3.5.72.0/23
echo 3.5.76.0/22
echo 3.5.80.0/21
echo 3.5.128.0/19
echo 3.5.160.0/21
echo 3.5.168.0/23
echo 3.5.172.0/22
echo 3.5.176.0/20
echo 3.5.192.0/21
echo 3.5.202.0/23
echo 3.5.204.0/22
echo 3.5.208.0/20
echo 3.5.224.0/19
echo 3.6.0.0/15
echo 3.8.0.0/13
echo 3.16.0.0/12
echo 3.32.0.0/16
echo 3.33.34.0/23
echo 3.33.40.0/24
echo 3.33.42.0/23
echo 3.33.44.0/22
echo 3.33.128.0/17
echo 3.34.0.0/15
echo 3.36.0.0/14
echo 3.64.0.0/11
echo 3.96.0.0/14
echo 3.101.0.0/16
echo 3.102.0.0/15
echo 3.104.0.0/13
echo 3.112.0.0/14
echo 3.120.0.0/13
echo 3.128.0.0/12
echo 3.144.0.0/13
echo 3.160.0.0/13
echo 3.168.0.0/14
echo 3.172.0.0/17
echo 3.173.0.0/16
echo 3.174.0.0/15
echo 3.208.0.0/12
echo 3.224.0.0/12
echo 3.248.0.0/13
echo 4.77.205.0/24
echo 4.144.0.0/12
echo 4.160.0.0/11
echo 4.192.0.0/10
echo 5.8.25.0/24
echo 5.8.26.0/23
echo 5.8.35.0/24
echo 5.8.68.0/24
echo 5.8.70.0/24
echo 5.8.92.0/23
echo 5.8.94.0/24
echo 5.9.0.0/16
echo 5.10.244.0/22
echo 5.22.145.0/24
echo 5.22.155.0/24
echo 5.23.34.0/24
echo 5.39.0.0/17
echo 5.45.187.0/24
echo 5.60.0.0/20
echo 5.61.119.0/24
echo 5.62.34.0/24
echo 5.63.24.0/22
echo 5.63.28.0/24
echo 5.75.128.0/17
echo 5.101.96.0/20
echo 5.101.217.0/24
echo 5.101.219.0/24
echo 5.101.220.0/24
echo 5.101.222.0/23
echo 5.102.96.0/22
echo 5.102.108.0/22
echo 5.102.124.0/22
echo 5.135.0.0/16
echo 5.144.179.0/24
echo 5.157.136.0/24
echo 5.157.139.0/24
echo 5.174.0.0/16
echo 5.179.96.0/20
echo 5.180.76.0/22
echo 5.180.188.0/23
echo 5.180.191.0/24
echo 5.181.4.0/23
echo 5.181.78.0/24
echo 5.181.166.0/24
echo 5.181.200.0/24
echo 5.182.34.0/24
echo 5.182.84.0/23
echo 5.182.108.0/24
echo 5.182.111.0/24
echo 5.182.114.0/24
echo 5.183.100.0/23
echo 5.183.103.0/24
echo 5.183.176.0/23
echo 5.183.179.0/24
echo 5.183.207.0/24
echo 5.188.1.0/24
echo 5.188.71.0/24
echo 5.188.92.0/24
echo 5.188.94.0/23
echo 5.188.109.0/24
echo 5.188.120.0/24
echo 5.188.123.0/24
echo 5.188.126.0/23
echo 5.188.132.0/22
echo 5.188.151.0/24
echo 5.188.189.0/24
echo 5.188.239.0/24
echo 5.189.200.0/24
echo 5.189.202.0/24
echo 5.189.207.0/24
echo 5.189.220.0/24
echo 5.196.0.0/16
echo 5.226.179.0/24
echo 5.226.181.0/24
echo 5.252.26.0/23
echo 5.252.162.0/24
echo 5.252.198.0/24
echo 8.6.144.0/23
echo 8.6.146.0/24
echo 8.7.244.0/24
echo 8.8.4.0/24
echo 8.8.8.0/24
echo 8.9.231.0/24
echo 8.10.148.0/24
echo 8.12.10.0/24
echo 8.14.32.0/24
echo 8.14.199.0/24
echo 8.14.201.0/24
echo 8.14.202.0/23
echo 8.14.204.0/24
echo 8.17.205.0/24
echo 8.17.206.0/23
echo 8.18.50.0/24
echo 8.18.113.0/24
echo 8.18.128.0/24
echo 8.18.172.0/24
echo 8.18.194.0/23
echo 8.18.196.0/24
echo 8.19.8.0/24
echo 8.20.100.0/23
echo 8.20.103.0/24
echo 8.20.110.0/24
echo 8.20.122.0/23
echo 8.20.124.0/23
echo 8.20.126.0/24
echo 8.20.253.0/24
echo 8.21.8.0/23
echo 8.21.10.0/24
echo 8.21.12.0/23
echo 8.21.41.0/24
echo 8.21.110.0/23
echo 8.21.239.0/24
echo 8.23.139.0/24
echo 8.23.240.0/24
echo 8.24.8.0/21
echo 8.24.87.0/24
echo 8.24.243.0/24
echo 8.24.244.0/24
echo 8.25.96.0/23
echo 8.25.249.0/24
echo 8.26.94.0/24
echo 8.26.180.0/24
echo 8.26.182.0/24
echo 8.27.64.0/24
echo 8.27.66.0/23
echo 8.27.68.0/23
echo 8.27.79.0/24
echo 8.28.5.0/24
echo 8.28.20.0/24
echo 8.28.82.0/24
echo 8.28.126.0/23
echo 8.28.213.0/24
echo 8.29.105.0/24
echo 8.29.109.0/24
echo 8.29.224.0/24
echo 8.29.228.0/24
echo 8.29.230.0/23
echo 8.30.208.0/21
echo 8.30.234.0/24
echo 8.31.2.0/24
echo 8.31.160.0/23
echo 8.31.234.0/24
echo 8.33.96.0/21
echo 8.33.128.0/21
echo 8.33.136.0/23
echo 8.34.69.0/24
echo 8.34.70.0/23
echo 8.34.200.0/23
echo 8.34.202.0/24
echo 8.34.208.0/20
echo 8.35.57.0/24
echo 8.35.58.0/23
echo 8.35.149.0/24
echo 8.35.192.0/20
echo 8.35.211.0/24
echo 8.36.216.0/22
echo 8.36.220.0/24
echo 8.37.41.0/24
echo 8.37.43.0/24
echo 8.38.97.0/24
echo 8.38.147.0/24
echo 8.38.148.0/23
echo 8.38.172.0/24
echo 8.39.6.0/24
echo 8.39.18.0/24
echo 8.39.125.0/24
echo 8.39.126.0/24
echo 8.39.201.0/24
echo 8.39.202.0/23
echo 8.39.204.0/22
echo 8.39.212.0/22
echo 8.40.26.0/23
echo 8.40.28.0/22
echo 8.40.107.0/24
echo 8.40.111.0/24
echo 8.40.140.0/24
echo 8.41.5.0/24
echo 8.41.6.0/23
echo 8.41.36.0/23
echo 8.42.51.0/24
echo 8.42.52.0/24
echo 8.42.54.0/23
echo 8.42.161.0/24
echo 8.42.164.0/24
echo 8.42.172.0/24
echo 8.42.245.0/24
echo 8.43.121.0/24
echo 8.43.122.0/23
echo 8.43.224.0/23
echo 8.43.226.0/24
echo 8.44.0.0/22
echo 8.44.6.0/24
echo 8.44.58.0/24
echo 8.44.60.0/22
echo 8.45.41.0/24
echo 8.45.43.0/24
echo 8.45.44.0/22
echo 8.45.97.0/24
echo 8.45.100.0/23
echo 8.45.102.0/24
echo 8.45.108.0/24
echo 8.45.111.0/24
echo 8.45.145.0/24
echo 8.45.146.0/23
echo 8.46.113.0/24
echo 8.46.114.0/23
echo 8.46.117.0/24
echo 8.46.118.0/23
echo 8.47.9.0/24
echo 8.47.12.0/22
echo 8.47.69.0/24
echo 8.47.71.0/24
echo 8.48.130.0/23
echo 8.48.132.0/23
echo 8.48.134.0/24
echo 9.141.0.0/16
echo 9.145.0.0/16
echo 9.146.0.0/16
echo 9.160.0.0/16
echo 9.163.0.0/16
echo 9.169.0.0/16
echo 9.205.0.0/16
echo 9.223.0.0/16
echo 9.234.0.0/15
echo 12.221.133.0/24
echo 13.32.0.0/15
echo 13.35.0.0/16
echo 13.36.0.0/14
echo 13.40.0.0/14
echo 13.48.0.0/12
echo 13.64.0.0/11
echo 13.104.0.0/14
echo 13.112.0.0/14
echo 13.124.0.0/14
echo 13.128.0.0/16
echo 13.130.0.0/16
echo 13.134.0.0/15
echo 13.144.0.0/16
echo 13.146.0.0/16
echo 13.150.0.0/15
echo 13.152.0.0/16
echo 13.154.0.0/16
echo 13.158.0.0/15
echo 13.160.0.0/16
echo 13.162.0.0/16
echo 13.166.0.0/15
echo 13.184.0.0/13
echo 13.192.0.0/11
echo 13.224.0.0/12
echo 13.244.0.0/14
echo 13.248.0.0/18
echo 13.248.64.0/20
echo 13.248.80.0/24
echo 13.248.96.0/19
echo 13.248.128.0/17
echo 13.249.0.0/16
echo 13.250.0.0/15
echo 13.254.4.0/24
echo 14.102.228.0/23
echo 15.103.0.0/16
echo 15.128.0.0/16
echo 15.134.0.0/15
echo 15.145.0.0/22
echo 15.145.4.0/23
echo 15.145.8.0/21
echo 15.145.16.0/21
echo 15.145.24.0/23
echo 15.152.0.0/16
echo 15.156.0.0/15
echo 15.158.0.0/16
echo 15.160.0.0/15
echo 15.164.0.0/15
echo 15.168.0.0/16
echo 15.177.0.0/18
echo 15.177.64.0/19
echo 15.177.96.0/21
echo 15.177.104.0/23
echo 15.177.106.0/24
echo 15.181.0.0/17
echo 15.181.128.0/18
echo 15.181.192.0/19
echo 15.181.224.0/20
echo 15.181.240.0/21
echo 15.181.248.0/22
echo 15.181.252.0/23
echo 15.181.254.0/24
echo 15.184.0.0/15
echo 15.188.0.0/16
echo 15.190.0.0/17
echo 15.190.128.0/19
echo 15.190.236.0/22
echo 15.190.240.0/20
echo 15.193.0.0/19
echo 15.193.128.0/19
echo 15.193.160.0/20
echo 15.193.176.0/22
echo 15.197.0.0/19
echo 15.197.32.0/21
echo 15.197.64.0/19
echo 15.197.128.0/17
echo 15.200.0.0/16
echo 15.204.0.0/14
echo 15.216.0.0/15
echo 15.220.0.0/19
echo 15.220.32.0/21
echo 15.220.40.0/22
echo 15.220.48.0/20
echo 15.220.64.0/19
echo 15.220.112.0/20
echo 15.220.128.0/18
echo 15.220.192.0/20
echo 15.220.208.128/26
echo 15.220.216.0/21
echo 15.220.224.0/19
echo 15.221.0.0/19
echo 15.221.32.0/20
echo 15.221.48.0/22
echo 15.221.52.0/23
echo 15.221.128.0/21
echo 15.221.144.0/21
echo 15.221.152.0/23
echo 15.221.160.0/21
echo 15.221.176.0/20
echo 15.222.0.0/15
echo 15.224.0.0/15
echo 15.228.0.0/15
echo 15.230.0.4/30
echo 15.230.0.8/31
echo 15.230.0.12/31
echo 15.230.0.14/32
echo 15.230.1.0/24
echo 15.230.3.0/24
echo 15.230.4.16/31
echo 15.230.4.19/32
echo 15.230.4.128/30
echo 15.230.4.148/30
echo 15.230.4.152/29
echo 15.230.4.160/29
echo 15.230.4.176/28
echo 15.230.5.0/24
echo 15.230.6.0/24
echo 15.230.9.10/31
echo 15.230.9.12/30
echo 15.230.9.44/30
echo 15.230.9.248/32
echo 15.230.9.252/31
echo 15.230.10.0/24
echo 15.230.14.0/24
echo 15.230.15.0/32
echo 15.230.15.3/32
echo 15.230.15.4/30
echo 15.230.15.8/30
echo 15.230.15.13/32
echo 15.230.15.14/31
echo 15.230.15.16/32
echo 15.230.15.24/29
echo 15.230.15.32/27
echo 15.230.15.64/26
echo 15.230.15.128/26
echo 15.230.15.192/30
echo 15.230.15.200/29
echo 15.230.15.208/29
echo 15.230.15.216/30
echo 15.230.15.254/31
echo 15.230.16.0/24
echo 15.230.18.0/23
echo 15.230.21.0/24
echo 15.230.22.0/23
echo 15.230.24.0/21
echo 15.230.32.0/24
echo 15.230.35.0/24
echo 15.230.36.0/22
echo 15.230.40.0/22
echo 15.230.48.0/21
echo 15.230.56.0/22
echo 15.230.60.0/23
echo 15.230.62.0/24
echo 15.230.63.0/30
echo 15.230.63.4/31
echo 15.230.63.6/32
echo 15.230.63.8/30
echo 15.230.64.0/21
echo 15.230.72.0/22
echo 15.230.76.0/23
echo 15.230.78.0/24
echo 15.230.79.0/25
echo 15.230.79.128/26
echo 15.230.80.0/20
echo 15.230.96.0/22
echo 15.230.100.0/31
echo 15.230.100.2/32
echo 15.230.101.0/24
echo 15.230.102.0/23
echo 15.230.104.0/23
echo 15.230.106.0/24
echo 15.230.107.0/32
echo 15.230.107.2/31
echo 15.230.108.0/22
echo 15.230.112.0/22
echo 15.230.116.0/24
echo 15.230.117.0/31
echo 15.230.118.0/24
echo 15.230.119.0/31
echo 15.230.120.0/31
echo 15.230.121.0/29
echo 15.230.121.8/31
echo 15.230.122.0/29
echo 15.230.123.0/24
echo 15.230.129.0/24
echo 15.230.130.0/23
echo 15.230.132.0/22
echo 15.230.136.0/23
echo 15.230.138.0/24
echo 15.230.140.0/22
echo 15.230.144.0/23
echo 15.230.147.0/24
echo 15.230.148.0/24
echo 15.230.149.0/30
echo 15.230.149.4/31
echo 15.230.149.8/30
echo 15.230.150.0/23
echo 15.230.152.0/21
echo 15.230.160.0/21
echo 15.230.168.0/24
echo 15.230.169.0/29
echo 15.230.170.0/23
echo 15.230.173.0/24
echo 15.230.174.0/24
echo 15.230.176.0/23
echo 15.230.178.0/24
echo 15.230.179.0/28
echo 15.230.179.16/29
echo 15.230.180.0/22
echo 15.230.184.0/22
echo 15.230.188.0/23
echo 15.230.190.0/24
echo 15.230.192.0/22
echo 15.230.196.0/23
echo 15.230.198.0/24
echo 15.230.199.0/28
echo 15.230.200.0/23
echo 15.230.202.0/30
echo 15.230.203.0/24
echo 15.230.204.0/25
echo 15.230.205.0/24
echo 15.230.206.0/23
    )
) else (
    echo Disabling cloudflare bypass...
    >"%FILE%" (
        echo 0.0.0.0/32
    )
)

echo Done.
pause